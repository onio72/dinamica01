<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Problema de dinámica (I)</title>
    <style>
        canvas {
            border: 1px solid black;
        }
        .controls {
            margin: 10px 0;
        }
        .questions {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Problema de dinámica (I)</h1>
    <p>Autor: Antonio González García</p>
    <canvas id="canvas" width="1000" height="700"></canvas>
    <div class="controls">
        <label for="mass1">Masa del objeto sobre la mesa (kg):</label>
        <input type="range" id="mass1" min="1" max="10" step="0.1" value="5">
        <span id="mass1Display">5</span> kg
        <br>
        <label for="mass2">Masa del objeto colgante (kg):</label>
        <input type="range" id="mass2" min="1" max="10" step="0.1" value="5">
        <span id="mass2Display">5</span> kg
        <br>
        <label for="friction">Coeficiente de rozamiento:</label>
        <input type="range" id="friction" min="0" max="1" step="0.01" value="0.1">
        <span id="frictionDisplay">0.1</span>
        <br>
        <button id="startButton">Iniciar</button>
        <button id="stopButton">Detener</button>
        <button id="resetButton">Reiniciar</button>
        <br>
        <input type="checkbox" id="showForces">
        <label for="showForces">Mostrar fuerzas y aceleración</label>
        <br>
        <input type="checkbox" id="slowMotion">
        <label for="slowMotion">Ralentizar movimiento</label>
        <br>
        <label for="timeDisplay">Tiempo:</label>
        <input type="text" id="timeDisplay" readonly>
    </div>

    <div class="questions">
        <p>Pregunta 1: ¿Qué ocurre con la tensión si se aumenta la masa del objeto que cuelga?</p>
        <input type="radio" name="q1" value="a"> a) Aumenta<br>
        <input type="radio" name="q1" value="b"> b) Disminuye<br>
        <input type="radio" name="q1" value="c"> c) Permanece igual<br>

        <p>Pregunta 2: Si el coeficiente de rozamiento aumenta, ¿qué ocurre con la tensión?</p>
        <input type="radio" name="q2" value="a"> a) Aumenta<br>
        <input type="radio" name="q2" value="b"> b) Disminuye<br>
        <input type="radio" name="q2" value="c"> c) Permanece igual<br>

        <p>Pregunta 3: ¿Y con la aceleración?</p>
        <input type="radio" name="q3" value="a"> a) Aumenta<br>
        <input type="radio" name="q3" value="b"> b) Disminuye<br>
        <input type="radio" name="q3" value="c"> c) Permanece igual<br>

        <p>Pregunta 4: Si se fija el coeficiente de rozamiento, ¿cualquier valor de la masa del objeto que cuelga provoca aceleración?</p>
        <input type="radio" name="q4" value="a"> a) Sí<br>
        <input type="radio" name="q4" value="b"> b) No<br>
        
        <button id="submitAnswers">Enviar respuestas</button>
    </div>

    <p id="results"></p>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const mass1Slider = document.getElementById('mass1');
        const mass2Slider = document.getElementById('mass2');
        const frictionSlider = document.getElementById('friction');
        const mass1Display = document.getElementById('mass1Display');
        const mass2Display = document.getElementById('mass2Display');
        const frictionDisplay = document.getElementById('frictionDisplay');
        const startButton = document.getElementById('startButton');
        const stopButton = document.getElementById('stopButton');
        const resetButton = document.getElementById('resetButton');
        const showForcesCheckbox = document.getElementById('showForces');
        const slowMotionCheckbox = document.getElementById('slowMotion');
        const timeDisplay = document.getElementById('timeDisplay');
        const submitAnswersButton = document.getElementById('submitAnswers');
        const results = document.getElementById('results');

        let animationId;
        let running = false;
        let mass1 = parseFloat(mass1Slider.value);
        let mass2 = parseFloat(mass2Slider.value);
        let friction = parseFloat(frictionSlider.value);
        let acceleration = 0;
        let tension = 0;
        let x1 = 100; // Initial position of mass1
        let y2 = 350; // Initial position of mass2
        let velocity = 0; // Initial velocity
        let time = 0; // Initial time
        let timeStep = 0.02; // Time step for the animation
        const poleaRadius = 20; // Radio de la polea

        function updateValues() {
            mass1 = parseFloat(mass1Slider.value);
            mass2 = parseFloat(mass2Slider.value);
            friction = parseFloat(frictionSlider.value);
            mass1Display.textContent = mass1;
            mass2Display.textContent = mass2;
            frictionDisplay.textContent = friction;
            draw(); // Redraw with updated sizes
        }

        function calculateForces() {
            const g = 9.8; // gravedad
            const f_gravity2 = mass2 * g;
            const f_friction = friction * mass1 * g;
            const f_net = f_gravity2 - f_friction;
            if (f_net > 0) {
                acceleration = f_net / (mass1 + mass2);
                tension = mass1 * acceleration + f_friction;
            } else {
                acceleration = 0;
                tension = f_gravity2;
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Mesa
            ctx.fillStyle = 'gray';
            ctx.fillRect(50, 300, 900, 10);

            // Tamaño de las masas
            const size1 = 40 + mass1 * 3; // Variación de tamaño
            const size2 = 40 + mass2 * 3; // Variación de tamaño

            // Masa 1
            ctx.fillStyle = 'blue';
            ctx.fillRect(x1, 300 - size1 / 2, size1, size1);

            // Polea
            ctx.beginPath();
            ctx.arc(950, 300, poleaRadius, 0, 2 * Math.PI);
            ctx.stroke();

            // Cuerda
            ctx.beginPath();
            ctx.moveTo(x1 + size1, 300); // Punto medio del lado derecho de masa 1
            ctx.lineTo(950, 280); // Punto de tangencia con la polea
            ctx.lineTo(970, y2 + size2 / 2); // Punto medio del lado más alto de masa 2
            ctx.stroke();

            // Masa 2
            ctx.fillStyle = 'red';
            ctx.fillRect(945, y2, size2, size2);

            if (showForcesCheckbox.checked) {
                ctx.fillStyle = 'red';
                ctx.fillText(`Tensión: ${tension.toFixed(2)} N`, 150, 50);
                ctx.fillText(`Aceleración: ${acceleration.toFixed(2)} m/s²`, 150, 70);
                ctx.fillStyle = 'black';
            }

            timeDisplay.value = time.toFixed(2) + ' s';
        }

        function animate() {
            if (!running) return;

            calculateForces();
            velocity += acceleration * timeStep;
            x1 += velocity * timeStep * (slowMotionCheckbox.checked ? 0.1 : 1);
            y2 += velocity * timeStep * (slowMotionCheckbox.checked ? 0.1 : 1);
            time += timeStep * (slowMotionCheckbox.checked ? 0.1 : 1);

            if (x1 >= 900 - (40 + mass1 * 3)) { // Ajuste de tamaño en la posición final
                running = false;
            }

            draw();
            animationId = requestAnimationFrame(animate);
        }

        startButton.addEventListener('click', () => {
            if (!running) {
                running = true;
                animate();
            }
        });

        stopButton.addEventListener('click', () => {
            running = false;
            cancelAnimationFrame(animationId);
        });

        resetButton.addEventListener('click', () => {
            running = false;
            cancelAnimationFrame(animationId);
            mass1Slider.value = 5;
            mass2Slider.value = 5;
            frictionSlider.value = 0.1;
            x1 = 100;
            y2 = 350;
            velocity = 0;
            time = 0;
            updateValues();
        });

        mass1Slider.addEventListener('input', updateValues);
        mass2Slider.addEventListener('input', updateValues);
        frictionSlider.addEventListener('input', updateValues);

        submitAnswersButton.addEventListener('click', () => {
            let correctAnswers = 0;
            if (document.querySelector('input[name="q1"]:checked').value === 'a') correctAnswers++;
            if (document.querySelector('input[name="q2"]:checked').value === 'b') correctAnswers++;
            if (document.querySelector('input[name="q3"]:checked').value === 'b') correctAnswers++;
            if (document.querySelector('input[name="q4"]:checked').value === 'b') correctAnswers++;

            results.textContent = `Preguntas acertadas: ${correctAnswers} de 4`;
        });

        updateValues();
        draw();
    </script>
</body>
</html>
